title: Oracle SOA Suite 12.2.1.4 (BYOL)
description: Oracle SOA Suite 12.2.1.4 on Oracle Cloud Infrastructure (OCI)
logoUrl: https://cloudmarketplace.oracle.com/marketplace/content?contentId=155351548
schemaVersion: 1.1.0
version: "20190304"
source:
  type: marketplace
  reference: 74792101
groupings:
  - title: "Service Instance"
    variables:
      - ${service_name}
      - ${wls_version}
      - ${topology}
      - ${use_schema_partitioning}
      - ${instance_shape}
      - ${enable_secure_boot}
      - ${enable_measured_boot}
      - ${ssh_public_key}
      - ${wls_node_count}
      - ${wls_scaleout_node_count}
      - ${scaleout_copy_binaries}
      - ${wls_admin_user}
      - ${wls_admin_password}
      - ${wls_kms_admin_secret_compartment_id}
      - ${wls_kms_admin_password_ocid}
      - ${volume_size}

  - title: "Key Management Service Configuration"
    visible: ${orm_create_mode}
    variables:
      - ${use_kms_decryption}
      - ${create_policies}

  - title: "Instance Network"
    variables:
      - ${network_compartment_id}
      - ${vcn_strategy}
      - ${existing_vcn_id}
      - ${wls_vcn_name}
      - ${wls_vcn_cidr}
      - ${use_soa_nsg}
      - ${soa_nsg_compartment_id}
      - ${soa_nsg_id}
      - ${subnet_strategy_existing_vcn}
      - ${subnet_strategy_new_vcn}
      - ${subnet_compartment_id}
      - ${subnet_type}
      - ${subnet_span}
      - ${wls_subnet_id}
      - ${wls_availability_domain_name}
      - ${wls_subnet_cidr}
      - ${bastion_strategy}
      - ${private_endpoint_strategy}
      - ${private_endpoint_compartment_id}
      - ${private_endpoint_id}
      - ${private_endpoint_subnet_compartment_id}
      - ${private_endpoint_subnet_cidr}
      - ${private_endpoint_subnet_id}
      - ${use_private_endpoint_nsg}
      - ${private_endpoint_nsg_compartment_id}
      - ${private_endpoint_nsg_id}
      - ${bastion_subnet_compartment_id}
      - ${bastion_public_ip}
      - ${bastion_ssh_pvt_key}
      - ${bastion_subnet_id}
      - ${bastion_subnet_cidr}
      - ${bastion_instance_shape}
      - ${use_bastion_nsg}
      - ${bastion_nsg_compartment_id}
      - ${bastion_nsg_id}
      - ${add_load_balancer}
      - ${load_balancer_strategy}
      - ${lb_compartment_id}
      - ${existing_load_balancer}
      - ${lb_subnet_compartment_id}
      - ${lb_subnet_type}
      - ${lb_subnet_1_id}
      - ${lb_subnet_2_id}
      - ${lb_subnet_1_availability_domain_name}
      - ${lb_subnet_1_cidr}
      - ${lb_subnet_2_availability_domain_name}
      - ${lb_subnet_2_cidr}
      - ${lb_shape}
      - ${lb_flex_min_shape}
      - ${lb_flex_max_shape}
      - ${use_lb_nsg}
      - ${lb_nsg_compartment_id}
      - ${lb_nsg_id}
      - ${lb_use_https}

  - title: "Identity Cloud Service (IDCS) Integration"
    visible: false
    variables:
      - ${is_idcs_selected}
      - ${idcs_host}
      - ${idcs_port}
      - ${idcs_tenant}
      - ${idcs_client_id}
      - ${idcs_client_secret}
      - ${idcs_cloudgate_port}

  - title: "Database"
    visible: ${orm_create_mode}
    variables:
      - ${db_strategy_existing_vcn}
      - ${db_strategy_new_vcn}
      - ${atp_db_compartment_id}
      - ${atp_db_id}
      - ${atp_db_password}
      - ${atp_kms_db_secret_compartment_id}
      - ${atp_kms_db_password_ocid}
      - ${atp_db_level}
      - ${custom_atp_db_level}
      - ${ocidb_compartment_id}
      - ${ocidb_dbsystem_id}
      - ${ocidb_dbhome_id}
      - ${ocidb_dbhome_major_version}
      - ${ocidb_database_id}
      - ${ocidb_pdb_service_name}
      - ${oci_db_user}
      - ${oci_db_password}
      - ${oci_kms_db_secret_compartment_id}
      - ${oci_kms_db_password_ocid}
      - ${oci_db_port}
      - ${exa_scan_dns_name}
#      - ${exa_host_domain_name}
#      - ${is_exadata_version_11}
#      - ${exa_db_unique_name}
      - ${exa_pdb_service_name}
      - ${exa_db_user}
      - ${exa_db_password}
      - ${exa_kms_db_secret_compartment_id}
      - ${exa_kms_db_password_ocid}
      - ${exa_db_port}
      - ${adv_db_connectstring}
      - ${adv_db_user}
      - ${adv_db_password}
      - ${adv_kms_db_secret_compartment_id}
      - ${adv_kms_db_password_ocid}
      - ${use_custom_schema_prefix}
      - ${rcu_schema_prefix}
      - ${use_custom_schema_password}
      - ${rcu_schema_password}
      - ${rcu_kms_schema_secret_compartment_id}
      - ${rcu_kms_schema_password_ocid}

  - title: "File Storage"
    visible:
         and:
            - ${orm_create_mode}
            - or:
                - and:
                     - eq:
                         - ${vcn_strategy}
                         - "Create New VCN"
                     - eq:
                         - ${db_strategy_new_vcn}
                         - "Autonomous Transaction Processing Database"
                - and:
                     - eq:
                         - ${vcn_strategy}
                         - "Use Existing VCN"
                     - eq:
                         - ${db_strategy_existing_vcn}
                         - "Autonomous Transaction Processing Database"

    variables:
      - ${use_file_storage}
#      - ${file_system_strategy}
      - ${file_system_compartment_id}
      - ${file_storage_availability_domain}
#       - ${file_system_ocid}
#      - ${file_system_name}
      - ${mount_target_strategy}
      - ${mount_target_compartment_id}
      - ${mount_target_subnet_id}
      - ${mount_target_ocid}
#      - ${mount_target_name}
      - ${mount_target_subnet_cidr}
      - ${use_mount_target_nsg}
      - ${mount_target_nsg_compartment_id}
      - ${mount_target_nsg_id}

  - title: "Service Instance Advanced"
    visible: ${orm_create_mode}
    variables:
      - ${use_advanced_wls_instance_config}
      - ${use_custom_nm_password}
      - ${wls_nm_password}
      - ${wls_kms_nm_secret_compartment_id}
      - ${wls_kms_nm_password_ocid}
      - ${wls_nm_port}
      - ${wls_console_port}
      - ${wls_console_ssl_port}
#      - ${wls_cluster_mc_port}
      - ${wls_extern_admin_port}
      - ${wls_extern_ssl_admin_port}
      - ${wls_ms_port}
      - ${wls_ms_ssl_port}
      - ${wls_coherence_cluster_port}
      - ${custom_cluster_name}
      - ${custom_domain_name}
      - ${custom_adminserver_name}
      - ${custom_managedserver_prefix}
      - ${custom_machinename_prefix}
      - ${deploy_sample_app}
      - ${use_custom_atp_db_wallet_password}
      - ${atp_db_wallet_password}
      - ${atp_kms_db_wallet_secret_compartment_id}
      - ${atp_kms_db_wallet_password_ocid}

  - title: "Backup/Restore Configuration (enabled with KMS configuraton)"
    visible: ${use_kms_decryption}
    variables:
      - ${use_backup_restore}
      - ${kms_vault_compartment_id}
      - ${kms_vault_ocid}
      - ${kms_key_ocid}
      - ${backup_obj_storage_bucket}

  - title: "Email Notification"
    visible: ${orm_create_mode}
    variables:
      - ${use_email_notification}
      - ${ons_topic_strategy}
      - ${ons_topic_ocid}
#      - ${ons_subscription_strategy}
#      - ${ons_subscription_ocid}
      - ${ons_subscription_emailid}

  - title: "Tags"
    variables:
      - ${service_tags}

#      - ${defined_tag}
#      - ${defined_tag_value}
#      - ${free_form_tag}
#      - ${free_form_tag_value}

  - title: "Hidden Variables"
    visible: false
    variables:
      - ${tenancy_ocid}
      - ${region}
      - ${compartment_ocid}
      - ${mode}
      - ${is_foh}
      - ${wls_dns_subnet_cidr}
      - ${wls_subnet_name}
      - ${private_endpoint_subnet_name}
      - ${private_endpoint_name}
      - ${bastion_subnet_name}
      - ${lb_subnet_1_name}
      - ${lb_subnet_2_name}
      - ${user_id}
      - ${fingerprint}
      - ${private_key_path}
      - ${wls_edition}
      - ${use_marketplace_image}
      - ${mp_listing_id}
      - ${mp_listing_resource_version}
      - ${log_level}
      - ${ocidb_vcn_cidr}
      - ${ocidb_dns_subnet_cidr}
      - ${instance_image_id}
      - ${use_regional_subnet}
      - ${assign_weblogic_public_ip}
#      - ${use_non_jrf}
      - ${enable_admin_console_access}
      - ${marketplace_source_images}
      - ${is_quickstart}
      - ${atp_db_name}
      - ${atp_db_license_model}
      - ${atp_db_workload}
      - ${atp_db_display_name}
      - ${atp_db_is_dedicated}
      - ${file_system_strategy}
      - ${file_system_ocid}
      - ${mount_target_subnet_name}
      - ${file_system_name}
      - ${mount_target_name}
      - ${mount_path}
      - ${skip_domain_creation}

variables:
  # SOA Instance Configuration
  service_name:
    type: string
    visible: ${orm_create_mode}
    minLength: 1
    maxLength: 15
    pattern: "^[a-zA-Z][a-zA-Z0-9]{0,15}$"
    title: Instance Name Prefix
    description: The names of all compute and network resources will begin with this prefix. It can only contain letters or numbers and must begin with a letter.
    required: true

  instance_image_id:
    type: oci:core:image:id
    required: true
    title: Instance Image OCID
    dependsOn:
      compartmentId: ${compartment_ocid}

  instance_shape:
    type: oci:core:instanceshapewithflex:name
    visible: true
    title: Compute Shape
    description: The compute shape for all service instances. SOA Suite requires minimum 15GB of memory. Choose VM.Standard 1.2 or higher shape.
    required: true
    dependsOn:
      compartmentId: ${compartment_ocid}
      imageId: ${instance_image_id}

  enable_secure_boot:
    type: boolean
    default: false
    visible: ${orm_create_mode}
    title: Enable Secure Boot
    description: Secure Boot is a Unified Extensible Firmware Interface (UEFI) feature that prevents unauthorized boot loaders and operating systems from booting.

  enable_measured_boot:
    type: boolean
    default: false
    visible:
        and:
            - ${orm_create_mode}
            - ${enable_secure_boot}
    title: Enable Measured Boot
    description: Measured Boot enhances boot security by taking and storing measurements of boot components, such as bootloaders, drivers, and operating systems. Bare metal instances do not support Measured Boot. The Trusted Platform Module (TPM) is used to securely store boot measurements.

  volume_size:
    type: integer
    visible: true
    title: Domain Volume Size (GB)
    description: The domain block volume size for the service instances. SOA Suite requires minimum 50GB of domain volume. You can only increase the domain block volume size post provisioning, decreasing of volume size not supported.
    minimum: 50
    maximum: 32000
    multipleOf: 1
    default: 50
    required: true

  ssh_public_key:
    type: oci:core:ssh:publickey
    visible: ${orm_create_mode}
    title: SSH Public Key
    description: Use the corresponding private key to access the service instances
    required: true
    sensitive: true

  wls_availability_domain_name:
    type: oci:identity:availabilitydomain:name
    visible:
      and:
        - ${orm_create_mode}
        - or:
          - and:
            - eq:
                - ${vcn_strategy}
                - "Use Existing VCN"
            - eq:
                - ${subnet_strategy_existing_vcn}
                - "Create New Subnet"
            - eq:
                - ${subnet_span}
                - "AD Specific Subnet"
          - and:
            - eq:
              - ${vcn_strategy}
              - "Create New VCN"
            - eq:
              - ${subnet_strategy_new_vcn}
              - "Create New Subnet"
            - eq:
                - ${subnet_span}
                - "AD Specific Subnet"
    title: Availability Domain
    description: The name of the availability domain in which to create the service instances
    required: true
    dependsOn:
      compartmentId: ${compartment_ocid}

  wls_node_count:
    type: integer
    title: Cluster Node Count
    visible: ${orm_create_mode}
    description: The number of managed servers in the cluster
    minimum: 1
    maximum: 8
    multipleOf: 1
    default: 1
    required: true

  wls_scaleout_node_count:
    type: integer
    title: Cluster Node Count
    visible:
         not:
            - ${orm_create_mode}
    description: The number of managed servers in the cluster
    minimum: 1
    maximum: 16
    multipleOf: 1
    default: ${wls_node_count}
    required: true


  scaleout_copy_binaries:
    type: boolean
    default: false
    visible:
         not:
            - ${orm_create_mode}
    title: Copy Middleware Home and Oracle Home from Admin VM
    description: If selected, the Middleware Home and Oracle Home are copied from Admin VM to the newly added node. It may take longer time to copy the binaries to newly added nodes. Please make sure you have enough disk space in /tmp on your Admin VM to create the binaries zip.

  wls_admin_user:
    type: string
    visible: ${orm_create_mode}
    title: Administration Username
    description: The WebLogic Server administrator username
    pattern: "^[a-zA-Z][a-zA-Z0-9]{7,127}$"
    minLength: 8
    maxLength: 128
    required: true

  wls_admin_password:
    type: password
    visible:
       and:
           - ${orm_create_mode}
           - not:
              - ${use_kms_decryption}
    title: Administration Password
    description: "The password for the administrator user in the Instance domain. Use a WebLogic Administrator password that starts with a letter, is between 8 and 30 characters long, contains at least one number, and, optionally, any number of the special characters ($ # _). For example, Ach1z0#d."
    required: true
    pattern: "^[a-zA-Z][a-zA-Z0-9$#_]{7,29}$"
    confirmation: true

  wls_kms_admin_secret_compartment_id:
    type: oci:identity:compartment:id
    visible:
       and:
           - ${orm_create_mode}
           - ${use_kms_decryption}
    title: WebLogic Server Admin Secret Compartment
    description: The compartment where you have the WebLogic Server administration secret
    required: true
    default: ${compartment_ocid}

  wls_kms_admin_password_ocid:
    type: "oci:kms:secret:id"
    visible:
       and:
           - ${orm_create_mode}
           - ${use_kms_decryption}
    title: Validated Secrets OCID for Administration Password
    description: "The OCID of the Secret that contains the password for the administrator user in the Instance domain. The value must begin with ocid1.vaultsecret. Use a WebLogic Administrator password that starts with a letter, is between 8 and 30 characters long, contains at least one number, and, optionally, any number of the special characters ($ # _). For example, Ach1z0#d."
    required: true
    dependsOn:
      compartmentId: ${wls_kms_admin_secret_compartment_id}

  # WLS Advanced Configuration Option
  use_advanced_wls_instance_config:
    type: boolean
    default: false
    title: "Service Instance Advanced Configuration"


  use_custom_nm_password:
    type: boolean
    default: false
    visible: ${use_advanced_wls_instance_config}
    title: Specify custom WLS Nodemanager Password
    description: If not selected, provisioner will set the WLS admin password to nodemanager password.

  wls_nm_password:
    type: password
    visible:
       and:
          - and:
               - ${use_advanced_wls_instance_config}
               - ${use_custom_nm_password}
          - not:
               - ${use_kms_decryption}
    title: Nodemanager Password
    description: "The password for the wls nodemanager in the Instance domain. Use a nodemanager password that starts with a letter, is between 8 and 30 characters long, contains at least one number, and, optionally, any number of the special characters ($ # _). For example, Ach1z0#d."
    confirmation: true

  wls_kms_nm_secret_compartment_id:
    type: oci:identity:compartment:id
    visible:
       and:
          - and:
               - ${use_advanced_wls_instance_config}
               - ${use_custom_nm_password}
          - ${use_kms_decryption}
    title: WebLogic Server Nodemanager Secret Compartment
    description: The compartment where you have the WebLogic Server Nodemanager secret
    required: true
    default: ${compartment_ocid}

  wls_kms_nm_password_ocid:
    type: "oci:kms:secret:id"
    visible:
       and:
          - and:
               - ${use_advanced_wls_instance_config}
               - ${use_custom_nm_password}
          - ${use_kms_decryption}
    title: Validated Secrets OCID for Nodemanager Password
    description: "The OCID of the Secret that contains the password for the wls nodemanager in the Instance domain. The value must begin with ocid1.vaultsecret. Use a nodemanager password that starts with a letter, is between 8 and 30 characters long, contains at least one number, and, optionally, any number of the special characters ($ # _). For example, Ach1z0#d."
    dependsOn:
      compartmentId: ${wls_kms_nm_secret_compartment_id}

  wls_nm_port:
    visible: ${use_advanced_wls_instance_config}
    type: integer
    default: 5556
    minimum: 1024
    maximum: 65535
    multipleOf: 1
    title: Node Manager Port
    description: The listen port number for the node manager process on all service instances
    required: true

  wls_console_port:
    visible: ${use_advanced_wls_instance_config}
    type: integer
    default: 9071
    minimum: 1024
    maximum: 65535
    multipleOf: 1
    title: Admin Console Port
    description: The administration server port on which to access the administration console
    required: true

  wls_console_ssl_port:
    visible: ${use_advanced_wls_instance_config}
    type: integer
    default: 9072
    minimum: 1024
    maximum: 65535
    multipleOf: 1
    title: Admin Console SSL Port
    description: The administration server SSL port on which to access the administration console
    required: true

  wls_cluster_mc_port:
    visible: false
    type: integer
    default: 5555
    minimum: 1024
    maximum: 65535
    multipleOf: 1
    title: Cluster Port
    description: The managed server port on which to send heartbeats and other internal cluster traffic (not applicable for Standard Edition)
    required: true

  wls_extern_admin_port:
    visible: ${use_advanced_wls_instance_config}
    type: integer
    default: 7001
    minimum: 1024
    maximum: 65535
    multipleOf: 1
    title: External Admin Port
    description: The server port on which to send administration traffic
    required: true

  wls_extern_ssl_admin_port:
    visible: ${use_advanced_wls_instance_config}
    type: integer
    default: 7002
    minimum: 1024
    maximum: 65535
    multipleOf: 1
    title: External Admin SSL Port
    description: The server SSL port on which to send administration traffic
    required: true

  wls_ms_port:
    visible: ${use_advanced_wls_instance_config}
    type: integer
    default: 9073
    minimum: 1024
    maximum: 65535
    multipleOf: 1
    title: Managed Server Port
    description: The managed server port on which to send application traffic
    required: true

  wls_ms_ssl_port:
    visible: ${use_advanced_wls_instance_config}
    type: integer
    default: 9074
    minimum: 1024
    maximum: 65535
    multipleOf: 1
    title: Managed Server SSL Port
    description: The managed server port on which to send application traffic
    required: true

  wls_coherence_cluster_port:
    visible: ${use_advanced_wls_instance_config}
    type: integer
    default: 7574
    minimum: 1024
    maximum: 8999
    multipleOf: 1
    title: Coherence Cluster Port
    description: The cluster listen port used by Coherence
    required: true

  custom_cluster_name:
    type: string
    visible: ${use_advanced_wls_instance_config}
    title: Custom Cluster Name
    description: The name of the cluster created in the WLS domain.
    required: false

  custom_domain_name:
    type: string
    visible: ${use_advanced_wls_instance_config}
    title: Custom Domain Name
    description: The name of the WLS domain.
    required: false

  custom_adminserver_name:
    type: string
    visible: ${use_advanced_wls_instance_config}
    title: Custom Admin Server Name
    description: The name of the Admin Server created in the WLS domain.
    required: false

  custom_managedserver_prefix:
    type: string
    visible: ${use_advanced_wls_instance_config}
    title: Custom Managed Server Name Prefix
    description: The prefix for the managed server name created in the WLS domain. An index number will be appended to the prefix to form the managed server name.
    required: false

  custom_machinename_prefix:
    type: string
    visible: ${use_advanced_wls_instance_config}
    title: Custom Machine Name Prefix
    description: The prefix for the machine name created in the WLS domain. An index number will be appended to the prefix to form the machine name.
    required: false

  deploy_sample_app:
    visible: ${use_advanced_wls_instance_config}
    type: boolean
    default: true
    title: Deploy Sample Application
    description: Enable to deploy an application named sample-app to the WebLogic Server cluster (for Standard Edition, the sample application will be targeted to the first managed server only)

  # Network Type Options
  network_compartment_id:
    type: oci:identity:compartment:id
    title: Network Compartment
    description: Choose the compartment in which to create the network resources such as virtual cloud network (VCN), security lists, route tables, and gateways.
    required: true
    visible: ${orm_create_mode}
    default: ${compartment_ocid}

  vcn_strategy:
    type: enum
    visible: ${orm_create_mode}
    title: Virtual Cloud Network Strategy
    description: Create or use an existing VCN in which to create the instances, network resources, and load balancers.
    enum:
      - "Create New VCN"
      - "Use Existing VCN"
    required: true
    default: "Use Existing VCN"

  subnet_strategy_existing_vcn:
    visible:
      and:
         - ${orm_create_mode}
         - eq:
             - ${vcn_strategy}
             - "Use Existing VCN"
    type: enum
    title: Subnet Strategy
    description: Create or use existing subnet
    enum:
      - "Create New Subnet"
      - "Use Existing Subnet"
    required: true
    default: ""

  subnet_strategy_new_vcn:
    visible:
      and:
         - ${orm_create_mode}
         - eq:
             - ${vcn_strategy}
             - "Create New VCN"
    type: enum
    title: Subnet Strategy
    description: Create or use existing subnet
    enum:
      - "Create New Subnet"
    required: true
    default: ""

  subnet_type:
    type: enum
    visible: ${orm_create_mode}
    title: Subnet Type
    description: Choose between private and public subnets
    enum:
      - "Use Private Subnet"
      - "Use Public Subnet"
    required: true
    default: "Use Public Subnet"

  subnet_span:
    type: enum
    visible: ${orm_create_mode}
    title: Subnet Span
    description: Choose between regional and AD specific subnets
    enum:
      - "Regional Subnet"
      - "AD Specific Subnet"
    required: true
    default: "Regional Subnet"

  # WLS Network Configuration
  wls_vcn_name:
    visible:
      and:
         - ${orm_create_mode}
         - eq:
             - ${vcn_strategy}
             - "Create New VCN"
    type: string
    default: ''
    minLength: 1
    maxLength: 255
    pattern: "^[a-zA-Z_]\\w{0,254}$"
    required: true
    title: SOA Server Network
    description: The name of the new Virtual Cloud Network (VCN) to create for this service

  existing_vcn_id:
    visible:
      and:
         - ${orm_create_mode}
         - eq:
             - ${vcn_strategy}
             - "Use Existing VCN"
    type: oci:core:vcn:id
    dependsOn:
      compartmentId: ${network_compartment_id}
    required: true
    title: Existing Network
    description: Choose the name of an existing VCN. If provisioning an Oracle SOA Suite on Marketplace instance in an existing subnet, configure security lists. See <a target=\"_blank\" href=\"https://docs.oracle.com/en/cloud/paas/soa/soa-marketplace/soamp-configure-security-lists.html#GUID-365C129E-AA39-43E8-A58C-2D92B7CF3E9E\">Configure Security Lists</a>

  wls_vcn_cidr:
    visible:
      and:
         - ${orm_create_mode}
         - eq:
             - ${vcn_strategy}
             - "Create New VCN"
    type: string
    default: 10.0.0.0/16
    pattern: "^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\/(3[0-2]|[1-2]?[0-9])$"
    title: SOA Server Network CIDR
    description: The CIDR to assign to the new virtual cloud network (VCN) to create for this service. This field is not required if you want to use an existing VCN.

  wls_subnet_cidr:
    visible:
      and:
         - ${orm_create_mode}
         - or:
             - and:
               - eq:
                   - ${vcn_strategy}
                   - "Use Existing VCN"
               - eq:
                   - ${subnet_strategy_existing_vcn}
                   - "Create New Subnet"
             - and:
               - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
               - eq:
                 - ${subnet_strategy_new_vcn}
                 - "Create New Subnet"
    type: string
    default: 10.0.3.0/24
    pattern: "^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\/(3[0-2]|[1-2]?[0-9])$"
    required: true
    title: Subnet CIDR
    description: "The CIDR of the new subnet to create for service instances. This field is required only if you want to use an existing VCN. The new subnet's CIDR should not overlap with any other subnet CIDRs."

  subnet_compartment_id:
    type: oci:identity:compartment:id
    title: Subnet Compartment
    description: Choose the compartment of the subnet.
    required: true
    visible: ${orm_create_mode}
    default: ${network_compartment_id}

  wls_subnet_id:
    visible:
      and:
         - ${orm_create_mode}
         - and:
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"
              - eq:
                  - ${subnet_strategy_existing_vcn}
                  - "Use Existing Subnet"
    type: oci:core:subnet:id
    dependsOn:
      vcnId: ${existing_vcn_id}
      compartmentId: ${subnet_compartment_id}
      hidePrivateSubnet:
        not:
          - eq:
              - ${subnet_type}
              - "Use Private Subnet"
      hidePublicSubnet:
        not:
          - eq:
              - ${subnet_type}
              - "Use Public Subnet"
      hideRegionalSubnet:
        not:
          - eq:
              - ${subnet_span}
              - "Regional Subnet"
      hideAdSubnet:
        not:
          - eq:
              - ${subnet_span}
              - "AD Specific Subnet"
    default: ''
    required: true
    title: Existing Subnet
    description: An existing subnet to use for service instances. This subnet must already be present in the chosen VCN. Configure the security lists required for provisioning SOAMP. See <a target=\"_blank\" href=\"https://docs.oracle.com/en/cloud/paas/soa/soa-marketplace/soamp-configure-security-lists.html#GUID-365C129E-AA39-43E8-A58C-2D92B7CF3E9E\">Configure Security Lists</a>

  assign_weblogic_public_ip:
    type: boolean
    default: true
    title: Assign Public IP Addresses to Instances
    description: If not selected, the service instances are created in a new private subnet. The compute instances, admin console, and applications will not be directly accessible from clients that are external to Oracle Cloud.

  bastion_strategy:
    type: enum
    visible:
      and:
         - ${orm_create_mode}
         - and:
             - eq:
                 - ${subnet_type}
                 - "Use Private Subnet"
             - and:
                 - eq:
                     - ${vcn_strategy}
                     - "Use Existing VCN"
                 - eq:
                     - ${subnet_strategy_existing_vcn}
                     - "Use Existing Subnet"
    title: Bastion Strategy
    description: Use a private endpoint or Create or use an existing Bastion compute instance. Private endpoint is the recommended option as it does not need a public subnet.
    enum:
      - "Use Private Endpoint"
      - "Create New Bastion Instance"
      - "Use Existing Bastion Instance"
    required: true
    default: "Use Private Endpoint"

  private_endpoint_strategy:
    type: enum
    visible:
      and:
         - ${orm_create_mode}
         - and:
             - and:
                 - eq:
                     - ${subnet_type}
                     - "Use Private Subnet"
                 - eq:
                     - ${bastion_strategy}
                     - "Use Private Endpoint"
             - and:
                 - eq:
                     - ${vcn_strategy}
                     - "Use Existing VCN"
                 - eq:
                     - ${subnet_strategy_existing_vcn}
                     - "Use Existing Subnet"
    title: Private Endpoint Strategy
    description: Create or use an existing private endpoint.
    enum:
      - "Create New Private Endpoint"
      - "Use Existing Private Endpoint"
    required: true
    default: "Create New Private Endpoint"


  private_endpoint_compartment_id:
    type: oci:identity:compartment:id
    title: Private Endpoint Compartment
    description: Choose the compartment of the private endpoint.
    required: true
    visible:
      and:
        - ${orm_create_mode}
        - and:
            - eq:
                - ${subnet_type}
                - "Use Private Subnet"
            - eq:
                - ${bastion_strategy}
                - "Use Private Endpoint"
    default: ${network_compartment_id}

  private_endpoint_id:
    type: oci:resourcemanager:privateendpoint:id
    required: true
    visible:
      and:
        - ${orm_create_mode}
        - and:
            - eq:
                - ${subnet_type}
                - "Use Private Subnet"
            - and:
                - eq:
                    - ${bastion_strategy}
                    - "Use Private Endpoint"
                - eq:
                    - ${private_endpoint_strategy}
                    - "Use Existing Private Endpoint"
    dependsOn:
      compartmentId: private_endpoint_compartment_id
      vcnId: ${existing_vcn_id}
    title: Existing Private Endpoint
    description: Choose the private endpoint to be used during provisioning

  private_endpoint_subnet_compartment_id:
    type: oci:identity:compartment:id
    title: Private Subnet Compartment
    description: Choose the compartment of the private endpoint subnet.
    required: true
    visible:
      and:
        - ${orm_create_mode}
        - and:
            - eq:
                - ${subnet_type}
                - "Use Private Subnet"
            - and:
                - eq:
                    - ${bastion_strategy}
                    - "Use Private Endpoint"
                - eq:
                    - ${private_endpoint_strategy}
                    - "Create New Private Endpoint"
    default: ${network_compartment_id}


  private_endpoint_subnet_name:
    type: string
    default: 'private-endpoint-subnet'
    title: Private Endpoint Subnet Name
    description: Subnet name for private endpoint

  private_endpoint_subnet_cidr:
    visible:
      and:
        - ${orm_create_mode}
        - and:
            - eq:
                - ${subnet_type}
                - "Use Private Subnet"
            - and:
                - and:
                    - eq:
                        - ${bastion_strategy}
                        - "Use Private Endpoint"
                    - eq:
                        - ${private_endpoint_strategy}
                        - "Create New Private Endpoint"
                - or:
                    - and:
                        - eq:
                            - ${vcn_strategy}
                            - "Use Existing VCN"
                        - eq:
                            - ${subnet_strategy_existing_vcn}
                            - "Create New Subnet"
                    - and:
                        - eq:
                            - ${vcn_strategy}
                            - "Create New VCN"
                        - eq:
                            - ${subnet_strategy_new_vcn}
                            - "Create New Subnet"
    type: string
    default: 10.0.6.0/24
    pattern: "^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\/(3[0-2]|[1-2]?[0-9])$"
    required: true
    title: Private Endpoint Subnet CIDR
    description: "The CIDR of the new private subnet to create a private endpoint. This field is required only if you did not assign public IP addresses to SOA Server. The new subnet's CIDR should not overlap with any other subnet CIDRs."

  private_endpoint_subnet_id:
    visible:
      and:
        - ${orm_create_mode}
        - and:
            - eq:
                - ${subnet_type}
                - "Use Private Subnet"
            - and:
                - and:
                    - eq:
                        - ${bastion_strategy}
                        - "Use Private Endpoint"
                    - eq:
                        - ${private_endpoint_strategy}
                        - "Create New Private Endpoint"
                - and:
                    - eq:
                        - ${vcn_strategy}
                        - "Use Existing VCN"
                    - eq:
                        - ${subnet_strategy_existing_vcn}
                        - "Use Existing Subnet"

    type: oci:core:subnet:id
    dependsOn:
      vcnId: ${existing_vcn_id}
      compartmentId: ${private_endpoint_subnet_compartment_id}
      hidePublicSubnet: true
    default: ''
    required: true
    title: Private Endpoint Subnet
    description: Choose a private subnet for creating the private endpoint


  private_endpoint_name:
    type: string
    required: true
    visible:
      and:
          - ${orm_create_mode}
          - and:
              - eq:
                  - ${subnet_type}
                  - "Use Private Subnet"
              - and:
                  - eq:
                      - ${bastion_strategy}
                      - "Use Private Endpoint"
                  - eq:
                      - ${private_endpoint_strategy}
                      - "Create New Private Endpoint"
    title: Private Endpoint Display Name
    description: Name of the private endpoint


  bastion_public_ip:
    type: string
    visible:
      and:
        - ${orm_create_mode}
        - and:
            - eq:
                - ${subnet_type}
                - "Use Private Subnet"
            - eq:
                - ${bastion_strategy}
                - "Use Existing Bastion Instance"
    title: Public IP of Bastion Instance
    description: Use the corresponding Public IP to access the bastion instance.
    pattern: "^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])$"
    required: true

  bastion_ssh_pvt_key:
    type: text
    visible:
      and:
        - ${orm_create_mode}
        - and:
            - eq:
                - ${subnet_type}
                - "Use Private Subnet"
            - eq:
                - ${bastion_strategy}
                - "Use Existing Bastion Instance"
    title: SSH Private Key Bastion Instance
    description: Use the corresponding private key to access the bastion instance.
    sensitive: true
    required: true

  bastion_subnet_compartment_id:
    type: oci:identity:compartment:id
    title: Bastion Host Subnet Compartment
    description: Choose the compartment of the Bastion Host subnet.
    required: true
    visible:
      and:
        - ${orm_create_mode}
        - and:
            - eq:
                - ${subnet_type}
                - "Use Private Subnet"
            - eq:
                - ${bastion_strategy}
                - "Create New Bastion Instance"
    default: ${network_compartment_id}

  bastion_subnet_name:
    type: string
    default: 'bastion-subnet'
    title: Bastion Host Subnet Name
    description: Subnet name for Bastion host

  bastion_subnet_cidr:
    visible:
      and:
        - ${orm_create_mode}
        - and:
            - eq:
                - ${subnet_type}
                - "Use Private Subnet"
            - and:
                - eq:
                    - ${bastion_strategy}
                    - "Create New Bastion Instance"
                - or:
                    - and:
                        - eq:
                            - ${vcn_strategy}
                            - "Use Existing VCN"
                        - eq:
                            - ${subnet_strategy_existing_vcn}
                            - "Create New Subnet"
                    - and:
                        - eq:
                            - ${vcn_strategy}
                            - "Create New VCN"
                        - eq:
                            - ${subnet_strategy_new_vcn}
                            - "Create New Subnet"
    type: string
    default: 10.0.7.0/24
    pattern: "^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\/(3[0-2]|[1-2]?[0-9])$"
    required: true
    title: Bastion Host Subnet CIDR
    description: "The CIDR of the new public subnet to create for a Bastion compute instance. This field is required only if you did not assign public IP addresses to SOA Server. The new subnet's CIDR should not overlap with any other subnet CIDRs."

  bastion_subnet_id:
    visible:
      and:
        - ${orm_create_mode}
        - and:
            - eq:
                - ${subnet_type}
                - "Use Private Subnet"
            - and:
                - eq:
                    - ${bastion_strategy}
                    - "Create New Bastion Instance"
                - and:
                    - eq:
                        - ${vcn_strategy}
                        - "Use Existing VCN"
                    - eq:
                        - ${subnet_strategy_existing_vcn}
                        - "Use Existing Subnet"
    type: oci:core:subnet:id
    dependsOn:
      vcnId: ${existing_vcn_id}
      compartmentId: ${bastion_subnet_compartment_id}
      hidePrivateSubnet: true
      hidePublicSubnet: false
      hideRegionalSubnet:
        not:
          - eq:
              - ${subnet_span}
              - "Regional Subnet"
      hideAdSubnet:
        not:
          - eq:
              - ${subnet_span}
              - "AD Specific Subnet"
    default: ''
    required: true
    title: Existing Subnet for Bastion Host
    description: An existing public subnet to use for a Bastion compute instance. This subnet must already be present in the chosen VCN. This field is required only if you did not assign public IP addresses to WebLogic Server.

  bastion_instance_shape:
    visible:
       and:
         - ${orm_create_mode}
         - and:
             - eq:
                 - ${bastion_strategy}
                 - "Create New Bastion Instance"
             - eq:
                 - ${subnet_type}
                 - "Use Private Subnet"
    type: oci:core:instanceshape:name
    title: Bastion Host Shape
    description: The shape for bastion compute instance.
    required: true
    dependsOn:
      compartmentId: ${compartment_ocid}

  # Load Balancer Configuration
  add_load_balancer:
    type: boolean
    default: false
    title: Provision Load Balancer
    description: Provision a load balancer in Oracle Cloud Infrastructure to distribute application traffic to the WebLogic cluster

  load_balancer_strategy:
    type: enum
    visible: ${add_load_balancer}
    title: Load Balancer Strategy
    description: Create or use an existing load balancer.
    enum:
      - "Create New Load Balancer"
      - "Use Existing Load Balancer"
    required: true
    default: "Create New Load Balancer"

  lb_compartment_id:
    type: oci:identity:compartment:id
    title: Load Balancer Compartment
    description: Choose the compartment of the Load Balancer.
    required: true
    visible: ${add_load_balancer}
    default: ${network_compartment_id}

  existing_load_balancer:
    type: oci:loadbalancer:loadbalancer:id
    title: Existing Load balancer
    required: true
    visible:
        and:
          - ${add_load_balancer}
          - eq:
              - ${load_balancer_strategy}
              - "Use Existing Load Balancer"
    dependsOn:
      compartmentId: ${lb_compartment_id}

  lb_subnet_compartment_id:
    type: oci:identity:compartment:id
    title: Load Balancer Subnet Compartment
    description: Choose the compartment of the Load Balancer subnet.
    required: true
    visible:
        and:
          - ${add_load_balancer}
          - eq:
              - ${load_balancer_strategy}
              - "Create New Load Balancer"
    default: ${network_compartment_id}


  lb_subnet_type:
    type: enum
    title: Load Balancer Subnet Type
    description: Choose between private and public subnets
    visible:
      and:
        - ${add_load_balancer}
        - and:
            - eq:
                - ${load_balancer_strategy}
                - "Create New Load Balancer"
            - eq:
                - ${subnet_type}
                - "Use Private Subnet"
    enum:
      - "Use Private Subnet"
      - "Use Public Subnet"
    required: true
    default: "Use Public Subnet"

  lb_subnet_1_availability_domain_name:
    visible:
      and:
        - ${add_load_balancer}
        - and:
            - eq:
                - ${load_balancer_strategy}
                - "Create New Load Balancer"
            - and:
                  - or:
                    - and:
                        - eq:
                            - ${vcn_strategy}
                            - "Use Existing VCN"
                        - eq:
                            - ${subnet_strategy_existing_vcn}
                            - "Create New Subnet"
                    - and:
                        - eq:
                            - ${vcn_strategy}
                            - "Create New VCN"
                        - eq:
                            - ${subnet_strategy_new_vcn}
                            - "Create New Subnet"
                  - eq:
                      - ${subnet_span}
                      - "AD Specific Subnet"
    type: oci:identity:availabilitydomain:name
    dependsOn:
      compartmentId: ${lb_subnet_compartment_id}
      hidePrivateSubnet:
        not:
          - eq:
              - ${lb_subnet_type}
              - "Use Private Subnet"
      hidePublicSubnet:
        not:
          - eq:
              - ${lb_subnet_type}
              - "Use Public Subnet"
      hideRegionalSubnet:
        not:
          - eq:
              - ${subnet_span}
              - "Regional Subnet"
      hideAdSubnet:
        not:
          - eq:
              - ${subnet_span}
              - "AD Specific Subnet"
    title: LB Availability Domain for subnet 1
    description: The availability domain to use for the second load balancer node. This field is required only if you are using AD-specific subnets.
    default: ''

  lb_subnet_2_availability_domain_name:
    visible:
      and:
        - ${add_load_balancer}
        - and:
            - eq:
                - ${load_balancer_strategy}
                - "Create New Load Balancer"
            - and:
                - or:
                    - and:
                        - eq:
                            - ${vcn_strategy}
                            - "Use Existing VCN"
                        - eq:
                            - ${subnet_strategy_existing_vcn}
                            - "Create New Subnet"
                    - and:
                        - eq:
                            - ${vcn_strategy}
                            - "Create New VCN"
                        - eq:
                            - ${subnet_strategy_new_vcn}
                            - "Create New Subnet"
                - eq:
                    - ${subnet_span}
                    - "AD Specific Subnet"
    type: oci:identity:availabilitydomain:name
    dependsOn:
      compartmentId: ${lb_subnet_compartment_id}
      hidePrivateSubnet:
        not:
          - eq:
              - ${lb_subnet_type}
              - "Use Private Subnet"
      hidePublicSubnet:
        not:
          - eq:
              - ${lb_subnet_type}
              - "Use Public Subnet"
      hideRegionalSubnet:
        not:
          - eq:
              - ${subnet_span}
              - "Regional Subnet"
      hideAdSubnet:
        not:
          - eq:
              - ${subnet_span}
              - "AD Specific Subnet"
    title: LB Availability Domain for subnet 2
    description: Select LB Availability Domain. Only required if provisioning with Load Balancer is selected.
    default: ''

  lb_subnet_1_cidr:
    visible:
      and:
        - ${add_load_balancer}
        - and:
            - eq:
                - ${load_balancer_strategy}
                - "Create New Load Balancer"
            - or:
                - and:
                    - eq:
                        - ${vcn_strategy}
                        - "Use Existing VCN"
                    - eq:
                        - ${subnet_strategy_existing_vcn}
                        - "Create New Subnet"
                - and:
                    - eq:
                        - ${vcn_strategy}
                        - "Create New VCN"
                    - eq:
                        - ${subnet_strategy_new_vcn}
                        - "Create New Subnet"
    type: string
    default: 10.0.4.0/24
    pattern: "^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\/(3[0-2]|[1-2]?[0-9])$"
    required: true
    title: Load Balancer Subnet CIDR
    description: "The CIDR of the new subnet to create for the load balancer. The new subnet's CIDR should not overlap with any other subnet CIDRs."

  lb_subnet_1_id:
    visible:
      and:
        - ${add_load_balancer}
        - and:
            - eq:
                - ${load_balancer_strategy}
                - "Create New Load Balancer"
            - and:
                - eq:
                    - ${vcn_strategy}
                    - "Use Existing VCN"
                - eq:
                    - ${subnet_strategy_existing_vcn}
                    - "Use Existing Subnet"
    type: oci:core:subnet:id
    dependsOn:
      vcnId: ${existing_vcn_id}
      compartmentId: ${lb_subnet_compartment_id}
      hidePrivateSubnet:
        not:
          - eq:
              - ${lb_subnet_type}
              - "Use Private Subnet"
      hidePublicSubnet:
        not:
          - eq:
              - ${lb_subnet_type}
              - "Use Public Subnet"
      hideRegionalSubnet:
        not:
          - eq:
              - ${subnet_span}
              - "Regional Subnet"
      hideAdSubnet:
        not:
          - eq:
              - ${subnet_span}
              - "AD Specific Subnet"
    default: ''
    required: true
    title: Existing Subnet for Load Balancer
    description: An existing subnet to use for the load balancer. This subnet must already be present in the chosen VCN.

  lb_subnet_2_cidr:
    visible:
      and:
        - ${add_load_balancer}
        - and:
            - eq:
                - ${load_balancer_strategy}
                - "Create New Load Balancer"
            - and:
                - or:
                    - and:
                        - eq:
                            - ${vcn_strategy}
                            - "Use Existing VCN"
                        - eq:
                            - ${subnet_strategy_existing_vcn}
                            - "Create New Subnet"
                    - and:
                        - eq:
                            - ${vcn_strategy}
                            - "Create New VCN"
                        - eq:
                            - ${subnet_strategy_new_vcn}
                            - "Create New Subnet"
                - eq:
                    - ${subnet_span}
                    - "AD Specific Subnet"
    type: string
    default: 10.0.5.0/24
    pattern: "^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\/(3[0-2]|[1-2]?[0-9])$"
    required: true
    title: Load Balancer Subnet 2 CIDR
    description: "The CIDR of the subnet to create for the second load balancer node. This field is required only if you are not using regional subnets. The new subnet's CIDR should not overlap with any other subnet CIDRs."

  lb_subnet_2_id:
    visible:
      and:
        - ${add_load_balancer}
        - and:
            - eq:
                - ${load_balancer_strategy}
                - "Create New Load Balancer"
            - and:
                - and:
                    - eq:
                        - ${vcn_strategy}
                        - "Use Existing VCN"
                    - eq:
                        - ${subnet_strategy_existing_vcn}
                        - "Use Existing Subnet"
                - eq:
                    - ${subnet_span}
                    - "AD Specific Subnet"
    type: oci:core:subnet:id
    dependsOn:
      vcnId: ${existing_vcn_id}
      compartmentId: ${lb_subnet_compartment_id}
      hidePrivateSubnet:
        not:
          - eq:
              - ${lb_subnet_type}
              - "Use Private Subnet"
      hidePublicSubnet:
        not:
          - eq:
              - ${lb_subnet_type}
              - "Use Public Subnet"
      hideRegionalSubnet:
        not:
          - eq:
              - ${subnet_span}
              - "Regional Subnet"
      hideAdSubnet:
        not:
          - eq:
              - ${subnet_span}
              - "AD Specific Subnet"
    default: ''
    required: true
    title: Existing Subnet 2 for Load Balancer
    description: An existing subnet to use for the second load balancer node. This field is required only if you are not using regional subnets.


  lb_shape:
    visible:
        and:
            - ${add_load_balancer}
            - eq:
                - ${load_balancer_strategy}
                - "Create New Load Balancer"
    type: enum
    required: true
    title: Load balancer Shape
    description: Choose the shape for the load balancer
    enum:
      - 100Mbps
      - 400Mbps
      - 8000Mbps
      - Flexible
    default: 400Mbps

  lb_flex_min_shape:
    visible:
       and:
          - ${add_load_balancer}
          - and:
              - eq:
                  - ${load_balancer_strategy}
                  - "Create New Load Balancer"
              - eq:
                  - ${lb_shape}
                  - "Flexible"
    type: integer
    title: Minimum size of Flexible Shape (Mbps)
    description: Choose the minimum bandwidth of the Flexible Shape in Mbps.
    required: true
    default: 10
    minimum: 10
    maximum: 8000
    multipleOf: 1

  lb_flex_max_shape:
    visible:
       and:
          - ${add_load_balancer}
          - and:
              - eq:
                  - ${load_balancer_strategy}
                  - "Create New Load Balancer"
              - eq:
                  - ${lb_shape}
                  - "Flexible"
    type: integer
    title: Maximum size of Flexible Shape (Mbps)
    description: Choose the maximum bandwidth of the Flexible Shape in Mbps. This value should be greater than or equal to the minimum bandwidth of the Flexible Shape.
    required: true
    default: 100
    minimum: 10
    maximum: 8000
    multipleOf: 1

  lb_use_https:
    visible: false
    type: boolean
    default: true
    title: Prepare load balancer for HTTPS
    description: Configure the load balancer to receive requests using HTTPS and to forward requests to WebLogic Server using HTTP. Add your SSL certificate to the load balancer's listener after the stack is created.

  # DB Type Selection
  db_strategy_existing_vcn:
    visible:
      eq:
        - ${vcn_strategy}
        - "Use Existing VCN"
    type: enum
    title: Database Strategy
    description: Choose the database strategy for WebLogic Server
    enum:
      - "Autonomous Transaction Processing Database"
      - "Database System"
      - "Exadata Database"
      - "Database Connection String (not recommended)"
    default: "Autonomous Transaction Processing Database"
    required: true

  db_strategy_new_vcn:
    visible:
      eq:
        - ${vcn_strategy}
        - "Create New VCN"
    type: enum
    title: Database Strategy
    description: Choose the database strategy for WebLogic Server
    enum:
      - "Autonomous Transaction Processing Database"
      - "Database System"
      - "Exadata Database"
    default: "Autonomous Transaction Processing Database"
    required: true

  # ATP DB Configuration
  atp_db_compartment_id:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Autonomous Transaction Processing Database"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Autonomous Transaction Processing Database"
    type: oci:identity:compartment:id
    default: ${compartment_ocid}
    required: true
    title: Autonomous DB System Compartment
    description: The compartment in which the DB System is found

  atp_db_id:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Autonomous Transaction Processing Database"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Autonomous Transaction Processing Database"
    type: oci:database:autonomousdatabase:id
    dependsOn:
      compartmentId: ${atp_db_compartment_id}
    required: true
    title: Autonomous Database
    description: The Autonomous Transaction Processing (ATP) database in which to provision the schemas for a JRF-enabled WebLogic Server domain

  atp_db_password:
    visible:
      and:
        - not:
            - ${use_kms_decryption}
        - or:
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Create New VCN"
              - eq:
                  - ${db_strategy_new_vcn}
                  - "Autonomous Transaction Processing Database"
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"
              - eq:
                  - ${db_strategy_existing_vcn}
                  - "Autonomous Transaction Processing Database"
    type: password
    required: true
    title: Autonomous Database ADMIN Password
    description: "The password for the ADMIN user in the autonomous database."

  atp_kms_db_secret_compartment_id:
    type: oci:identity:compartment:id
    visible:
      and:
        - ${use_kms_decryption}
        - or:
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Create New VCN"
              - eq:
                  - ${db_strategy_new_vcn}
                  - "Autonomous Transaction Processing Database"
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"
              - eq:
                  - ${db_strategy_existing_vcn}
                  - "Autonomous Transaction Processing Database"
    title: ATP DB Secret Compartment
    description: The compartment where you have the ATP DB secret
    required: true
    default: ${compartment_ocid}

  atp_kms_db_password_ocid:
    type: "oci:kms:secret:id"
    visible:
      and:
        - ${use_kms_decryption}
        - or:
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Create New VCN"
              - eq:
                  - ${db_strategy_new_vcn}
                  - "Autonomous Transaction Processing Database"
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"
              - eq:
                  - ${db_strategy_existing_vcn}
                  - "Autonomous Transaction Processing Database"
    title: Validated Secrets OCID for Autonomous Database ADMIN Password
    description: "The OCID of the Secret that contains the password for the ADMIN user in the autonomous database. The value must begin with ocid1.vaultsecret."
    required: true
    dependsOn:
      compartmentId: ${atp_kms_db_secret_compartment_id}


  use_custom_atp_db_wallet_password:
    type: boolean
    default: false
    visible:
      and:
        - ${use_advanced_wls_instance_config}
        - or:
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Create New VCN"
              - eq:
                  - ${db_strategy_new_vcn}
                  - "Autonomous Transaction Processing Database"
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"
              - eq:
                  - ${db_strategy_existing_vcn}
                  - "Autonomous Transaction Processing Database"
    title: Specify custom ATP wallet Password
    description: If not selected, provisioner will use auto-generated wallet password during provisioning.

  atp_db_wallet_password:
    visible:
      and:
        - and:
            - and:
                - ${use_advanced_wls_instance_config}
                - or:
                    - and:
                         - eq:
                             - ${vcn_strategy}
                             - "Create New VCN"
                         - eq:
                             - ${db_strategy_new_vcn}
                             - "Autonomous Transaction Processing Database"
                    - and:
                         - eq:
                             - ${vcn_strategy}
                             - "Use Existing VCN"
                         - eq:
                             - ${db_strategy_existing_vcn}
                             - "Autonomous Transaction Processing Database"
            - ${use_custom_atp_db_wallet_password}
        - not:
            - ${use_kms_decryption}
    type: password
    title: Autonomous Database Wallet Password
    description: The password to the client credentials wallet for the ATP database.

  atp_kms_db_wallet_secret_compartment_id:
    type: oci:identity:compartment:id
    visible:
      and:
        - and:
            - and:
                - ${use_advanced_wls_instance_config}
                - or:
                    - and:
                         - eq:
                             - ${vcn_strategy}
                             - "Create New VCN"
                         - eq:
                             - ${db_strategy_new_vcn}
                             - "Autonomous Transaction Processing Database"
                    - and:
                         - eq:
                             - ${vcn_strategy}
                             - "Use Existing VCN"
                         - eq:
                             - ${db_strategy_existing_vcn}
                             - "Autonomous Transaction Processing Database"
            - ${use_custom_atp_db_wallet_password}
        - ${use_kms_decryption}
    title: ATP DB Wallet Secret Compartment
    description: The compartment where you have the ATP DB wallet secret
    required: true
    default: ${compartment_ocid}

  atp_kms_db_wallet_password_ocid:
    type: "oci:kms:secret:id"
    visible:
      and:
        - and:
            - and:
                - ${use_advanced_wls_instance_config}
                - or:
                    - and:
                         - eq:
                             - ${vcn_strategy}
                             - "Create New VCN"
                         - eq:
                             - ${db_strategy_new_vcn}
                             - "Autonomous Transaction Processing Database"
                    - and:
                         - eq:
                             - ${vcn_strategy}
                             - "Use Existing VCN"
                         - eq:
                             - ${db_strategy_existing_vcn}
                             - "Autonomous Transaction Processing Database"
            - ${use_custom_atp_db_wallet_password}
        - ${use_kms_decryption}
    title: Validated Secrets OCID for ATP DB Wallet Password
    description: "The OCID of the Secret that contains the password for the ATP DB wallet. The value must begin with ocid1.vaultsecret."
    dependsOn:
      compartmentId: ${atp_kms_db_wallet_secret_compartment_id}

  atp_db_level:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Autonomous Transaction Processing Database"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Autonomous Transaction Processing Database"
    type: enum
    enum:
      - low
      - tp
      - tpurgent
      - Custom Service Level
    default: low
    title: Autonomous Database Service Level
    description: The service level that the SOA Server domain should use to connect to the autonomous database. The default is low.

  custom_atp_db_level:
    type: string
    visible: 
      and:
          - or:
              - and:
                   - eq:
                       - ${vcn_strategy}
                       - "Create New VCN"
                   - eq:
                       - ${db_strategy_new_vcn}
                       - "Autonomous Transaction Processing Database"
              - and:
                   - eq:
                       - ${vcn_strategy}
                       - "Use Existing VCN"
                   - eq:
                       - ${db_strategy_existing_vcn}
                       - "Autonomous Transaction Processing Database"
          - eq:
              - ${atp_db_level}
              - "Custom Service Level"
    title: Custom Autonomous Database Service Level
    description: The custom service level that the SOA Server domain should use to connect to the autonomous database.
    required: false

  # OCI DB Configuration
#  Commented out for V1 release - as DB and WLS need to be in same VCN in same compartment.
  ocidb_compartment_id:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Database System"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Database System"
    type: oci:identity:compartment:id
    required: true
    default: ${compartment_ocid}
    title: DB System Compartment
    description: The compartment in which the DB System is found

  ocidb_dbsystem_id:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Database System"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Database System"
    type: oci:database:dbsystem:id
    dependsOn:
      compartmentId: ${ocidb_compartment_id}
    required: true
    title: DB System
    description: Choose the Oracle Cloud Infrastructure DB System to use for this WebLogic Server domain. This should be either in the same VCN as SOA instances or local VCN peering has to be configured between Database VCN and SOA instance VCN.

  ocidb_dbhome_id:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Database System"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Database System"
    type: oci:database:dbhome:id
    required: true
    title: Database home in the DB System
    description: Choose the database home within the DB System
    dependsOn:
      compartmentId: ${ocidb_compartment_id}
      dbSystemId: ${ocidb_dbsystem_id}

  ocidb_dbhome_major_version:
    visible: false
    type: oci:database:dbhome:dbversion
    title: Version of Database home in the DB System
    description: The version of database home within the DB System
    dependsOn:
      dbHomeId: ${ocidb_dbhome_id}

  ocidb_database_id:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Database System"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Database System"
    type: oci:database:database:id
    dependsOn:
      compartmentId: ${ocidb_compartment_id}
      dbHomeId: ${ocidb_dbhome_id}
    required: true
    title: Database in the DB System
    description: Choose the database within the DB System in which to provision the schemas for a JRF-enabled WebLogic Server domain

  ocidb_pdb_service_name:
    visible:
      and:
        - not:
            - eq:
                - ${ocidb_dbhome_major_version}
                - "11"
        - or:
            - and:
                 - eq:
                     - ${vcn_strategy}
                     - "Create New VCN"
                 - eq:
                     - ${db_strategy_new_vcn}
                     - "Database System"
            - and:
                 - eq:
                     - ${vcn_strategy}
                     - "Use Existing VCN"
                 - eq:
                     - ${db_strategy_existing_vcn}
                     - "Database System"
    type: string
    required: true
    title: PDB Service Name
    description: The service name of the pluggable database (PDB) in which to provision the schemas for a JRF-enabled WebLogic Server domain. If PDB name alone is provided, provisioning scripts will generate the connect string using the default admin service name which is not recommended. This is required for Oracle Database 12c or later.

  oci_db_user:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Database System"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Database System"
    type: string
    default: SYS
    pattern: "^[a-zA-Z][a-zA-Z0-9]{1,49}$"
    minLength: 2
    maxLength: 50
    title: Database Administrator
    description: The name of a database user with database administrator (DBA) privileges
    required: true

  oci_db_password:
    visible:
      and :
        - not:
          - ${use_kms_decryption}
        - or:
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Create New VCN"
              - eq:
                  - ${db_strategy_new_vcn}
                  - "Database System"
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"
              - eq:
                  - ${db_strategy_existing_vcn}
                  - "Database System"
    type: password
    required: true
    title: Database Administrator Password
    description: "The password for the database administrator."

  oci_kms_db_secret_compartment_id:
    type: oci:identity:compartment:id
    visible:
      and :
        - ${use_kms_decryption}
        - or:
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Create New VCN"
              - eq:
                  - ${db_strategy_new_vcn}
                  - "Database System"
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"
              - eq:
                  - ${db_strategy_existing_vcn}
                  - "Database System"
    title: OCI DB Secret Compartment
    description: The compartment where you have the OCI DB secret
    required: true
    default: ${compartment_ocid}

  oci_kms_db_password_ocid:
    type: "oci:kms:secret:id"
    visible:
      and :
        - ${use_kms_decryption}
        - or:
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Create New VCN"
              - eq:
                  - ${db_strategy_new_vcn}
                  - "Database System"
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"
              - eq:
                  - ${db_strategy_existing_vcn}
                  - "Database System"
    title: Validated Secrets OCID for Database Administrator Password
    description: "The OCID of the Secret that contains the password for the database administrator. The value must begin with ocid1.vaultsecret."
    required: true
    dependsOn:
      compartmentId: ${oci_kms_db_secret_compartment_id}

  oci_db_port:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Database System"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Database System"
    type: integer
    default: 1521
    minimum: 1024
    maximum: 65500
    multipleOf: 1
    title: Database Listener Port
    description: The listen port number for the database
    required: true

  exa_scan_dns_name:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Exadata Database"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Exadata Database"
    type: string
    title: Exadata SCAN DNS Name
    description: The SCAN DNS name of the Exadata VM Cluster. Refer to the Exadata VM Cluster details page in OCI Console for SCAN DNS name.
    required: true

#  exa_host_domain_name:
#    visible:
#        - or:
#            - eq:
#                - ${db_strategy_new_vcn}
#                - "Exadata Database"
#            - eq:
#                - ${db_strategy_existing_vcn}
#                - "Exadata Database"
#    type: string
#    title: Host Domain Name
#    description: The Host Domain name of the Exadata VM Cluster. This can be found in the Exadata VM Cluster details page in OCI Console.
#    required: true

#  is_exadata_version_11:
#    type: boolean
#    default: false
#    visible:
#      or:
#        - eq:
#            - ${db_strategy_new_vcn}
#            - "Exadata Database"
#        - eq:
#            - ${db_strategy_existing_vcn}
##    title: Is Database version 11.x
#  description: Select this checkbox if the Exadata Database version is 11.x

#  exa_db_unique_name:
#    visible:
#      and:
#        - ${is_exadata_version_11}
#        - or:
#            - eq:
#                - ${db_strategy_new_vcn}
#                - "Exadata Database"
#            - eq:
#                - ${db_strategy_existing_vcn}
#                - "Exadata Database"
#    type: string
#    title: Database Unique Name
#    description: The Database Unique name of the Exadata Database. Refer to the Database details page of the Exadata VM Cluster in the OCI Console for Database Unique name.
#    required: true

  exa_pdb_service_name:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Exadata Database"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Exadata Database"
    type: string
    required: true
    title: PDB Service name
    description: The pluggable database (PDB) service name in which to provision the schemas for a JRF-enabled WebLogic Server domain. This is required for Oracle Database 12c or later.

  exa_db_user:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Exadata Database"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Exadata Database"
    type: string
    default: SYS
    pattern: "^[a-zA-Z][a-zA-Z0-9]{1,49}$"
    minLength: 2
    maxLength: 50
    title: Database Administrator
    description: The name of a database user with database administrator (DBA) privileges
    required: true

  exa_db_password:
    visible:
      and:
        - not:
          - ${use_kms_decryption}
        - or:
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Create New VCN"
              - eq:
                  - ${db_strategy_new_vcn}
                  - "Exadata Database"
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"
              - eq:
                  - ${db_strategy_existing_vcn}
                  - "Exadata Database"
    type: password
    required: true
    title: Database Administrator Password
    description: "The password for the database administrator."

  exa_kms_db_secret_compartment_id:
    type: oci:identity:compartment:id
    visible:
      and:
        - ${use_kms_decryption}
        - or:
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Create New VCN"
              - eq:
                  - ${db_strategy_new_vcn}
                  - "Exadata Database"
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"
              - eq:
                  - ${db_strategy_existing_vcn}
                  - "Exadata Database"
    title: Exadata DB Secret Compartment
    description: The compartment where you have the Exadata DB secret
    required: true
    default: ${compartment_ocid}

  exa_kms_db_password_ocid:
    type: "oci:kms:secret:id"
    visible:
      and:
        - ${use_kms_decryption}
        - or:
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Create New VCN"
              - eq:
                  - ${db_strategy_new_vcn}
                  - "Exadata Database"
          - and:
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"
              - eq:
                  - ${db_strategy_existing_vcn}
                  - "Exadata Database"
    title: Validated Secrets OCID for Database Administrator Password
    description: "The OCID of the Secret that contains the password for the database administrator. The value must begin with ocid1.vaultsecret."
    required: true
    dependsOn:
      compartmentId: ${exa_kms_db_secret_compartment_id}

  exa_db_port:
    visible:
      or:
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Create New VCN"
             - eq:
                 - ${db_strategy_new_vcn}
                 - "Exadata Database"
        - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Exadata Database"
    type: integer
    default: 1521
    minimum: 1024
    maximum: 65500
    multipleOf: 1
    title: Database Listener Port
    description: The listen port number for the exadata database
    required: true

  adv_db_connectstring:
    visible:
        and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Database Connection String (not recommended)"
    type: string
    title: Database Connection String
    description: "The database connection string for running the RCU sripts and creating data sources. This option is only for advanced users, and not recommended. Syntax: host:port/serviceName"
    required: true

  adv_db_user:
    visible:
        and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Database Connection String (not recommended)"
    type: string
    default: SYS
    pattern: "^[a-zA-Z][a-zA-Z0-9]{1,49}$"
    minLength: 2
    maxLength: 50
    title: Database Administrator
    description: The name of a database user with database administrator (DBA) privileges
    required: true

  adv_db_password:
    visible:
      and:
          - not:
            - ${use_kms_decryption}
          - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Database Connection String (not recommended)"
    type: password
    required: true
    title: Database Administrator Password
    description: "The password for the database administrator."

  adv_kms_db_secret_compartment_id:
    type: oci:identity:compartment:id
    visible:
      and:
          - ${use_kms_decryption}
          - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Database Connection String (not recommended)"
    title: External DB Secret Compartment
    description: The compartment where you have the External DB secret
    required: true
    default: ${compartment_ocid}

  adv_kms_db_password_ocid:
    type: "oci:kms:secret:id"
    visible:
      and:
          - ${use_kms_decryption}
          - and:
             - eq:
                 - ${vcn_strategy}
                 - "Use Existing VCN"
             - eq:
                 - ${db_strategy_existing_vcn}
                 - "Database Connection String (not recommended)"
    title: Validated Secrets OCID for Database Administrator Password
    description: "The OCID of the Secret that contains the password for the database administrator. The value must begin with ocid1.vaultsecret."
    required: true
    dependsOn:
      compartmentId: ${adv_kms_db_secret_compartment_id}

  # KMS variables
  use_kms_decryption:
    type: boolean
    default: false
    title: "Use KMS Vault Secrets for passwords"
    description: Enable Key Management Service (KMS) vault secrets for passwords.

  create_policies:
    visible:
        and :
           - ${orm_create_mode}
           - ${use_kms_decryption}
    type: boolean
    default: true
    title: OCI Policies
    description: Create policies to read Secrets from Vault. Deselecting this option is for Advanced users only.
    required: false


  use_backup_restore:
      type: boolean
      visible: ${use_kms_decryption}
      default: false
      title: "Enable Backup/Restore configuration"
      description: Enable SOAMP domain backup/restore configuration. Backup/Restore requires KMS to be configured. Please make sure you have enough storage in domain block volume on all cluster nodes to create backup.

  kms_vault_compartment_id:
    type: oci:identity:compartment:id
    visible:
       and:
           - ${use_kms_decryption}
           - ${use_backup_restore}
    title: KMS Vault Compartment
    description: The compartment where you have the KMS vault
    required: true
    default: ${compartment_ocid}

  kms_vault_ocid:
    type: "oci:kms:vault:id"
    title: KMS Vault
    visible:
       and:
           - ${use_kms_decryption}
           - ${use_backup_restore}
    description: "The OCID of the KMS Vault used to encrypt the backup files."
    required: true
    dependsOn:
      compartmentId: ${kms_vault_compartment_id}

  kms_key_ocid:
    type: "oci:kms:key:id"
    title: KMS Encryption Key
    visible:
       and:
           - ${use_kms_decryption}
           - ${use_backup_restore}
    description: "The OCID of the KMS Encryption key used to encrypt the backup files."
    required: true
    dependsOn:
      compartmentId: ${kms_vault_compartment_id}
      vaultId: ${kms_vault_ocid}

  backup_obj_storage_bucket:
    type: string
    visible:
       and:
           - ${use_kms_decryption}
           - ${use_backup_restore}
    title: Object Storage Bucket Name
    description: The object storage bucket used for storing the backup files.
    required: true

  # Tagging variables

  service_tags:
    type: oci:identity:tag:value
    title: Service Tags
    description: These tags will be added to the OCI resources created during SOAMP provisioning
    required: false

#  defined_tag:
#    type: string
#    title: Defined Tag key
#    minLength: 0
#    maxLength: 100
#    default: ''
#    description: The predefined defined tag with tag namespace and tag key. The values need to be provided as <tagnamespace>.<tagkey>. For example, Operations.CostCenter.
#    required: false
#
#  defined_tag_value:
#    type: string
#    title: Defined Tag value
#    minLength: 0
#    maxLength: 256
#    default: ''
#    description: The value of the defined tag
#    required: false
#
#  free_form_tag:
#    type: string
#    title: Free-form Tag key
#    minLength: 0
#    maxLength: 100
#    default: ''
#    description: The free-form tag key
#    required: false
#
#  free_form_tag_value:
#    type: string
#    title: Free-form Tag value
#    minLength: 0
#    maxLength: 256
#    default: ''
#    description: The value of the free-form tag
#    required: false

  # IDCS variables
  is_idcs_selected:
    type: boolean
    default: false
    title: Enable Authentication Using Identity Cloud Service
    description: Authenticate WebLogic Server users against Oracle Identity Cloud Service (IDCS). If not selected, WebLogic Server uses the local identity store.
    visible: ${add_load_balancer}

  idcs_host:
    visible:
      and:
        - ${add_load_balancer}
        - ${is_idcs_selected}
    type: string
    minLength: 1
    maxLength: 1024
    title: IDCS Host Domain Name
    description: The domain name for the host that you use to access Identity Cloud Service.
    required: true
    default: "identity.oraclecloud.com"

  idcs_port:
    visible:
      and:
        - ${add_load_balancer}
        - ${is_idcs_selected}
    type: integer
    default: 443
    minimum: 0
    maximum: 65535
    multipleOf: 1
    title: IDCS Port
    description: The port number that you use to access Identity Cloud Service
    required: true

  idcs_tenant:
    visible:
      and:
        - ${add_load_balancer}
        - ${is_idcs_selected}
    type: string
    minLength: 1
    maxLength: 1024
    title: IDCS Tenant
    description: The ID of your Identity Cloud Service tenant, which typically has the format idcs-<guid>, and is part of the host name that you use to access Identity Cloud Service
    required: true

  idcs_client_id:
    visible:
      and:
        - ${add_load_balancer}
        - ${is_idcs_selected}
    type: string
    minLength: 1
    maxLength: 1024
    title: IDCS Client ID
    description: The client ID of a confidential application in Identity Cloud Service that is used to create the necessary artifacts in Identity Cloud Service. This application needs to be configured as client, and has to be granted with access to Identity Cloud Service Admin APIs, with Identity Domain Administrator app role
    required: true

  idcs_client_secret:
    visible:
      and:
        - ${add_load_balancer}
        - ${is_idcs_selected}
    type: string
    minLength: 1
    maxLength: 1024
    title: IDCS Client Secret
    description: The encrypted client secret of a confidential application in Identity Cloud Service that is used to create the necessary artifacts in Identity Cloud Service
    required: true

  idcs_cloudgate_port:
    visible:
      and:
        - ${add_load_balancer}
        - ${is_idcs_selected}
    type: integer
    default: 9999
    minimum: 0
    maximum: 65535
    multipleOf: 1
    title: IDCS Redirect Port
    description: The listen port for the Identity Cloud Service App Gateway, which authenticates requests and redirects them to WebLogic Server
    required: true

  # Hidden Variables
  mode:
    type: enum
    title: Terraform mode
    description: Select Terraform mode for development or production. In development mode, local VM scripts zip is seeded on WLS VMs.
    enum:
      - PROD
      - DEV
    default: PROD

  wls_dns_subnet_cidr:
    type: string
    title: DNS Subnet CIDR
    description: DNS VM Subnet CIDR. Only required for Local VCN Peering.
    default: ''

  wls_subnet_name:
    type: string
    default: 'wls-subnet'
    title: Subnet Name
    description: The name of the new subnet to create for service instances. This field is required only if you want to use an existing VCN.

  lb_subnet_1_name:
    type: string
    default: 'lb-subnet-1'
    title: Load Balancer Subnet Name
    description: The name of the new subnet to create for the load balancer.

  lb_subnet_2_name:
    type: string
    default: 'lb-subnet-2'
    title: Load Balancer Subnet 2 Name
    description: The name of the subnet to create for the second load balancer node. This field is required only if you are not using regional subnets.

  user_id:
    type: string

  private_key_path:
    type: string

  fingerprint:
    type: string

  wls_edition:
    type: string

  use_regional_subnet:
    type: boolean

  use_marketplace_image:
    type: boolean
    default: true

#  use_bastion_marketplace_image:
#    type: boolean
#    default: true

  mp_listing_resource_version:
    type: string

  mp_listing_id:
    type: string

  tenancy_ocid:
    type: string
    title: Tenancy ID
    description: The Oracle Cloud Identifier (OCID) for your tenancy
    required: true

  region:
    type: oci:identity:region:name
    title: Region
    description: The region in which to create all resources
    required: true

  log_level:
    type: enum
    title: Log Level
    description: Log level
    enum:
      - DEBUG
      - INFO
    default: INFO

#  bastion_instance_image_id:
#    type: string
#    title: Bastion Instance OCID
#    description: The Oracle Cloud Identifier (OCID) for PIC image

#  mp_bastion_listing_id:
#    type: string
#    title: Bastion  Marketplace listing Id
#    description: The Bastion  Marketplace listing Id for PIC image

#  mp_bastion_listing_resource_version:
#    type: string
#    title: Bastion  Marketplace listing version
#    description: The Bastion  Marketplace listing version for PIC image

  compartment_ocid:
    type: oci:identity:compartment:id
    title: SOA Server Compartment
    description: The compartment in which to create the SOA Server compute instances
    required: true

  wls_version:
    type: enum
    visible: false
    title: Service Version
    description: The version of SOA Server to provision
    enum:
      - 12.2.1.3
      - 12.2.1.4
    default: 12.2.1.4

  topology:
    type: enum
    visible: ${orm_create_mode}
    title: Service Type
    required: true
    description: The service type to provision
    enum:
      - "SOA with SB & B2B Cluster"
      - "MFT Cluster"
      - "BAM Cluster"
    default: "SOA with SB & B2B Cluster"

  is_foh:
    type: boolean
    default: false
    visible: false
    title: Is Federated Oracle Home
    description: Select if FMW installed in Federated Oracle Home mode 

  use_schema_partitioning:
    type: boolean
    default: false
    visible:
       and:
          - ${orm_create_mode}
          - eq:
              - ${topology}
              - "SOA with SB & B2B Cluster"
    title: Enable SOA DB Schema Partitioning
    description: Enable the SOAINFRA DB Schema partitioning

  use_custom_schema_prefix:
    type: boolean
    default: false
    visible: true
    title: Specify custom RCU Schema Prefix
    description: If not selected, provisioner will create a random schema Prefix for RCU schemas.

  rcu_schema_prefix:
    type: string
    title: Custom RCU Schema Prefix
    visible: ${use_custom_schema_prefix}
    description: Custom RCU Schema prefix name. The schema prefix name has to be unique in the Database. It can only contain letters or numbers and must begin with a letter.
    pattern: "^[a-zA-Z][a-zA-Z0-9]{0,11}$"
    minLength: 1
    maxLength: 12
    required: true

  use_custom_schema_password:
    type: boolean
    default: false
    visible: true
    title: Specify RCU Schema custom Password
    description: If not selected, provisioner will create a random Schema password for RCU schemas.

  rcu_schema_password:
    type: password
    confirmation: true
    title: Custom RCU Schema Password
    visible:
       and:
           - ${use_custom_schema_password}
           - not:
              - ${use_kms_decryption}
    description: "The password for the RCU schema user. Use a RCU Schema password that starts with a letter, is 12 to 30 characters long, contains at least one number and two or more uppercase characters. Optionally it can have special characters ($ # _). Example aB##ePass12."
    pattern: "^(?=.*?[A-Z])(?=.*?[a-z])(?=.*[0-9])[a-zA-Z]([a-zA-Z0-9_#\\$])+$"
    minLength: 12
    maxLength: 30
    required: true

  rcu_kms_schema_secret_compartment_id:
    type: oci:identity:compartment:id
    visible:
       and:
           - ${use_custom_schema_password}
           - ${use_kms_decryption}
    title: RCU Schema Secret Compartment
    description: The compartment where you have the RCU schema secret
    required: true
    default: ${compartment_ocid}

  rcu_kms_schema_password_ocid:
    type: "oci:kms:secret:id"
    title: Validated Secrets OCID for Custom RCU Schema Password
    visible:
       and:
           - ${use_custom_schema_password}
           - ${use_kms_decryption}
    description: "The OCID of the Secret that contains the password for the RCU schema user. The value must begin with ocid1.vaultsecret. Use a RCU Schema password that starts with a letter, is 12 to 30 characters long, contains at least one number and two or more uppercase characters. Optionally it can have special characters ($ # _). Example aB##ePass12"
    required: true
    dependsOn:
      compartmentId: ${rcu_kms_schema_secret_compartment_id}

  use_file_storage:
    type: boolean
    visible:
      not:
         - eq:
            - ${topology}
            - "MFT Cluster"
    default: false
    title: "Configure File Storage for shared location in cluster nodes"

  file_system_strategy:
    type: enum
    visible: false
    title: File System Strategy
    description: Create or use an existing File system to configure the File Storage.
    enum:
      - "Create New File System"
      - "Use Existing File System"
    default: "Create New File System"
    required: true

  file_system_compartment_id:
    type: oci:identity:compartment:id
    visible:
          or:
            - ${use_file_storage}
            - and:
                 - or:
                     - and:
                          - eq:
                              - ${vcn_strategy}
                              - "Create New VCN"
                          - eq:
                              - ${db_strategy_new_vcn}
                              - "Autonomous Transaction Processing Database"
                     - and:
                          - eq:
                              - ${vcn_strategy}
                              - "Use Existing VCN"
                          - eq:
                              - ${db_strategy_existing_vcn}
                              - "Autonomous Transaction Processing Database"
                 - eq:
                     - ${topology}
                     - "MFT Cluster"
    required: true
    title: "File System Compartment"
    description: "Choose the compartment of the file system."
    default: ${network_compartment_id}

  file_storage_availability_domain:
    type: oci:identity:availabilitydomain:name
    visible:
          or:
            - ${use_file_storage}
            - and:
                 - or:
                     - and:
                          - eq:
                              - ${vcn_strategy}
                              - "Create New VCN"
                          - eq:
                              - ${db_strategy_new_vcn}
                              - "Autonomous Transaction Processing Database"
                     - and:
                          - eq:
                              - ${vcn_strategy}
                              - "Use Existing VCN"
                          - eq:
                              - ${db_strategy_existing_vcn}
                              - "Autonomous Transaction Processing Database"
                 - eq:
                     - ${topology}
                     - "MFT Cluster"
    title: File Storage Availability Domain
    description: The name of the availability domain in which to create the file system and mount target.
    required: true
    dependsOn:
      compartmentId: ${file_system_compartment_id}

  file_system_ocid:
    visible:
         and:
            - ${use_file_storage}
            - eq:
                - ${file_system_strategy}
                - "Use Existing File System"
    type: string
    required: true
    title: Existing File System OCID
    description: The OCID of the file system to be used for configuring the File storage.

  file_system_name:
    type: string
    required: true
    visible: false
    title: File System Display Name
    description: Name of the file system

  mount_target_strategy:
    type: enum
    title: Mount Target Strategy
    visible:
          and:
            - or:
                  - ${use_file_storage}
                  - and:
                       - or:
                           - and:
                                - eq:
                                    - ${vcn_strategy}
                                    - "Create New VCN"
                                - eq:
                                    - ${db_strategy_new_vcn}
                                    - "Autonomous Transaction Processing Database"
                           - and:
                                - eq:
                                    - ${vcn_strategy}
                                    - "Use Existing VCN"
                                - eq:
                                    - ${db_strategy_existing_vcn}
                                    - "Autonomous Transaction Processing Database"
                       - eq:
                           - ${topology}
                           - "MFT Cluster"
            - and:
                - eq:
                    - ${vcn_strategy}
                    - "Use Existing VCN"
                - eq:
                    - ${subnet_strategy_existing_vcn}
                    - "Use Existing Subnet"
    description: Create or use an existing mount target to mount the file system.
    enum:
      - "Create New Mount Target"
      - "Use Existing Mount Target"
    default: "Create New Mount Target"
    required: true

  mount_target_compartment_id:
    type: oci:identity:compartment:id
    visible:
          or:
            - ${use_file_storage}
            - and:
                 - or:
                     - and:
                          - eq:
                              - ${vcn_strategy}
                              - "Create New VCN"
                          - eq:
                              - ${db_strategy_new_vcn}
                              - "Autonomous Transaction Processing Database"
                     - and:
                          - eq:
                              - ${vcn_strategy}
                              - "Use Existing VCN"
                          - eq:
                              - ${db_strategy_existing_vcn}
                              - "Autonomous Transaction Processing Database"
                 - eq:
                     - ${topology}
                     - "MFT Cluster"
    required: true
    title: "Mount Target Compartment"
    description: "Choose the compartment of the mount target."
    default: ${network_compartment_id}

  mount_target_subnet_id:
    visible:
          and:
            - or:
                  - ${use_file_storage}
                  - and:
                       - or:
                           - and:
                                - eq:
                                    - ${vcn_strategy}
                                    - "Create New VCN"
                                - eq:
                                    - ${db_strategy_new_vcn}
                                    - "Autonomous Transaction Processing Database"
                           - and:
                                - eq:
                                    - ${vcn_strategy}
                                    - "Use Existing VCN"
                                - eq:
                                    - ${db_strategy_existing_vcn}
                                    - "Autonomous Transaction Processing Database"
                       - eq:
                           - ${topology}
                           - "MFT Cluster"
            - and:
                - eq:
                    - ${mount_target_strategy}
                    - "Create New Mount Target"
                - and:
                    - eq:
                        - ${vcn_strategy}
                        - "Use Existing VCN"
                    - eq:
                        - ${subnet_strategy_existing_vcn}
                        - "Use Existing Subnet"
    type: oci:core:subnet:id
    dependsOn:
      vcnId: ${existing_vcn_id}
      compartmentId: ${mount_target_compartment_id}

      hideRegionalSubnet:
          not:
            - eq:
              - ${subnet_span}
              - "Regional Subnet"
      hideAdSubnet:
          not:
            - eq:
              - ${subnet_span}
              - "AD Specific Subnet"
    default: ''
    required: true
    title: Mount Target Subnet
    description: Choose a subnet for creating the mount target.

  mount_target_subnet_name:
    type: string
    default: 'mount-target-subnet'
    title: Mount Target Subnet Name
    description: Subnet name for mount target.

  mount_target_subnet_cidr:
    visible:
            and:
                - or:
                    - ${use_file_storage}
                    - and:
                         - or:
                             - and:
                                  - eq:
                                      - ${vcn_strategy}
                                      - "Create New VCN"
                                  - eq:
                                      - ${db_strategy_new_vcn}
                                      - "Autonomous Transaction Processing Database"
                             - and:
                                  - eq:
                                      - ${vcn_strategy}
                                      - "Use Existing VCN"
                                  - eq:
                                      - ${db_strategy_existing_vcn}
                                      - "Autonomous Transaction Processing Database"
                         - eq:
                             - ${topology}
                             - "MFT Cluster"
                - or:
                    - and:
                        - eq:
                            - ${vcn_strategy}
                            - "Use Existing VCN"
                        - eq:
                            - ${subnet_strategy_existing_vcn}
                            - "Create New Subnet"
                    - and:
                        - eq:
                            - ${vcn_strategy}
                            - "Create New VCN"
                        - eq:
                            - ${subnet_strategy_new_vcn}
                            - "Create New Subnet"
    type: string
    default: 10.0.8.0/24
    pattern: "^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\/(3[0-2]|[1-2]?[0-9])$"
    required: true
    title: Mount Target Subnet CIDR
    description: "The CIDR of the new subnet to create a mount target."

  mount_target_ocid:
    visible:
         and:
            - or:
                 - ${use_file_storage}
                 - and:
                      - or:
                          - and:
                               - eq:
                                   - ${vcn_strategy}
                                   - "Create New VCN"
                               - eq:
                                   - ${db_strategy_new_vcn}
                                   - "Autonomous Transaction Processing Database"
                          - and:
                               - eq:
                                   - ${vcn_strategy}
                                   - "Use Existing VCN"
                               - eq:
                                   - ${db_strategy_existing_vcn}
                                   - "Autonomous Transaction Processing Database"
                      - eq:
                          - ${topology}
                          - "MFT Cluster"
            - eq:
                - ${mount_target_strategy}
                - "Use Existing Mount Target"
    type: string
    required: true
    title: Existing Mount Target OCID
    description: The OCID of the mount target to be used for mounting the file system.


  mount_path:
    type: string
    required: true
    visible: false
    title: Mount Path
    description: FSS mount path

  mount_target_name:
    type: string
    required: true
    visible: false
    title: Mount Target Display Name
    description: Name of the mount target

  use_mount_target_nsg:
    type: boolean
    default: false
    visible:
         and:
            - or:
                 - ${use_file_storage}
                 - and:
                      - or:
                          - and:
                               - eq:
                                   - ${vcn_strategy}
                                   - "Create New VCN"
                               - eq:
                                   - ${db_strategy_new_vcn}
                                   - "Autonomous Transaction Processing Database"
                          - and:
                               - eq:
                                   - ${vcn_strategy}
                                   - "Use Existing VCN"
                               - eq:
                                   - ${db_strategy_existing_vcn}
                                   - "Autonomous Transaction Processing Database"
                      - eq:
                          - ${topology}
                          - "MFT Cluster"
            - eq:
                - ${mount_target_strategy}
                - "Create New Mount Target"
    title: Use Network Security Group for Mount Target
    description: Use a network security group (NSG) for controlling traffic to the mount target.

  mount_target_nsg_compartment_id:
    type: oci:identity:compartment:id
    required: true
    title: "Network Security Group Compartment"
    description: "Choose the compartment of the network security group (NSG)."
    default: ${network_compartment_id}
    visible:
         and:
            - or:
                 - ${use_file_storage}
                 - and:
                      - or:
                          - and:
                               - eq:
                                   - ${vcn_strategy}
                                   - "Create New VCN"
                               - eq:
                                   - ${db_strategy_new_vcn}
                                   - "Autonomous Transaction Processing Database"
                          - and:
                               - eq:
                                   - ${vcn_strategy}
                                   - "Use Existing VCN"
                               - eq:
                                   - ${db_strategy_existing_vcn}
                                   - "Autonomous Transaction Processing Database"
                      - eq:
                          - ${topology}
                          - "MFT Cluster"
            - and:
                 - ${use_mount_target_nsg}
                 - eq:
                     - ${mount_target_strategy}
                     - "Create New Mount Target"

  mount_target_nsg_id:
    type: oci:core:nsg:id
    visible:
         and:
            - or:
                 - ${use_file_storage}
                 - and:
                      - or:
                          - and:
                               - eq:
                                   - ${vcn_strategy}
                                   - "Create New VCN"
                               - eq:
                                   - ${db_strategy_new_vcn}
                                   - "Autonomous Transaction Processing Database"
                          - and:
                               - eq:
                                   - ${vcn_strategy}
                                   - "Use Existing VCN"
                               - eq:
                                   - ${db_strategy_existing_vcn}
                                   - "Autonomous Transaction Processing Database"
                      - eq:
                          - ${topology}
                          - "MFT Cluster"
            - and:
                 - ${use_mount_target_nsg}
                 - eq:
                     - ${mount_target_strategy}
                     - "Create New Mount Target"
    required: true
    title: "Mount Target Network Security Group"
    description: "Network security group (NSG) to be used for controlling traffic to the mount target."
    dependsOn:
       compartmentId: ${mount_target_nsg_compartment_id}
       vcnId: ${existing_vcn_id}

  use_email_notification:
    type: boolean
    default: false
    title: "Enable Email notifications"

  ons_topic_strategy:
    visible: ${use_email_notification}
    type: enum
    title: ONS Topic Strategy
    description: Create or use an existing ONS Topic to configure the email notifications.
    enum:
      - "Create New ONS Topic"
      - "Use Existing ONS Topic"
    default: "Use Existing ONS Topic"
    required: true

  ons_topic_ocid:
    visible:
      and:
         - ${use_email_notification}
         - eq:
             - ${ons_topic_strategy}
             - "Use Existing ONS Topic"
    type: string
    required: true
    title: Existing ONS Topic OCID
    description: The OCID of the ONS Topic to be used for configuring the Email Notification.

#  ons_subscription_strategy:
#    visible:
#           and:
#               - ${use_email_notification}
#               - eq:
#                   - ${ons_topic_strategy}
#                   - "Create New ONS Topic"
#    title: ONS Subscription Strategy
#    description: Create or use an existing ONS Subscription to configure the ONS Topic.
#    enum:
#      - "Create New ONS Subscription"
#      - "Use Existing ONS Subscription"
#    default: "Use Existing ONS Subscription"
#    required: true

#  ons_subscription_ocid:
#    visible:
#      and:
#         - ${use_email_notification}
#         - and:
#              - eq:
#                  - ${ons_topic_strategy}
#                  - "Create New ONS Topic"
#              - eq:
#                  - ${ons_subscription_strategy}
#                  - "Use Existing ONS Subscription"
#    type: string
#    required: true
#    title: Existing ONS Subscription OCID
#    description: The OCID of the ONS Subscription to be used for configuring the ONS Topic.

  ons_subscription_emailid:
    visible:
      and:
         - ${use_email_notification}
         - eq:
             - ${ons_topic_strategy}
             - "Create New ONS Topic"
    type: string
    required: true
    title: Notification Email ID
    description: The Email ID to receive the notifications.


  use_soa_nsg:
    type: boolean
    default: false
    visible:
       eq:
             - ${vcn_strategy}
             - "Use Existing VCN"
    title: Use Network Security Group for SOA Instance
    description: Use network security group (NSG) for controlling traffic to the SOA instance.

  soa_nsg_compartment_id:
    type: oci:identity:compartment:id
    required: true
    title: "Network Security Group Compartment"
    description: "Choose the compartment of the network security group (NSG)."
    default: ${network_compartment_id}
    visible:
       and:
              - ${use_soa_nsg}
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"

  soa_nsg_id:
    type: oci:core:nsg:id
    visible:
      and:
              - ${use_soa_nsg}
              - eq:
                  - ${vcn_strategy}
                  - "Use Existing VCN"
    required: true
    title: "SOA Instance Network Security Group"
    description: "Network security group (NSG) to be used for controlling traffic to the SOA compute instance."
    dependsOn:
       compartmentId: ${soa_nsg_compartment_id}
       vcnId: ${existing_vcn_id}

  use_bastion_nsg:
    type: boolean
    default: false
    visible:
      and:
         - ${orm_create_mode}
         - and:
              - eq:
                  - ${bastion_strategy}
                  - "Create New Bastion Instance"
              - eq:
                  - ${subnet_type}
                  - "Use Private Subnet"
    title: Use Network Security Group for Bastion Host
    description: Use a network security group (NSG) for controlling traffic to the Bastion host.

  bastion_nsg_compartment_id:
    type: oci:identity:compartment:id
    required: true
    title: "Network Security Group Compartment"
    description: "Choose the compartment of the network security group (NSG)."
    default: ${network_compartment_id}
    visible:
       and:
         - ${orm_create_mode}
         - and:
              - ${use_bastion_nsg}
              - and:
                   - eq:
                       - ${bastion_strategy}
                       - "Create New Bastion Instance"
                   - eq:
                       - ${subnet_type}
                       - "Use Private Subnet"

  bastion_nsg_id:
    type: oci:core:nsg:id
    visible:
       and:
         - ${orm_create_mode}
         - and:
              - ${use_bastion_nsg}
              - and:
                   - eq:
                       - ${bastion_strategy}
                       - "Create New Bastion Instance"
                   - eq:
                       - ${subnet_type}
                       - "Use Private Subnet"
    required: true
    title: "Bastion Host Network Security Group"
    description: "Network security group (NSG) to be used for controlling traffic to the Bastion host."
    dependsOn:
       compartmentId: ${soa_nsg_compartment_id}
       vcnId: ${existing_vcn_id}

  use_private_endpoint_nsg:
    type: boolean
    default: false
    visible:
      and:
         - ${orm_create_mode}
         - and:
            - eq:
                - ${subnet_type}
                - "Use Private Subnet"
            - and:
                - eq:
                    - ${bastion_strategy}
                    - "Use Private Endpoint"
                - eq:
                    - ${private_endpoint_strategy}
                    - "Create New Private Endpoint"
    title: Use Network Security Group for Private Endpoint
    description: Use a network security group (NSG) for controlling traffic to the private endpoint.

  private_endpoint_nsg_compartment_id:
    type: oci:identity:compartment:id
    required: true
    title: "Network Security Group Compartment"
    description: "Choose the compartment of the network security group (NSG)."
    default: ${network_compartment_id}
    visible:
       and:
         - ${orm_create_mode}
         - and:
              - ${use_private_endpoint_nsg}
              - and:
                   - eq:
                        - ${subnet_type}
                        - "Use Private Subnet"
                   - and:
                        - eq:
                             - ${bastion_strategy}
                             - "Use Private Endpoint"
                        - eq:
                             - ${private_endpoint_strategy}
                             - "Create New Private Endpoint"

  private_endpoint_nsg_id:
    type: oci:core:nsg:id
    visible:
       and:
         - ${orm_create_mode}
         - and:
              - ${use_private_endpoint_nsg}
              - and:
                   - eq:
                        - ${subnet_type}
                        - "Use Private Subnet"
                   - and:
                        - eq:
                             - ${bastion_strategy}
                             - "Use Private Endpoint"
                        - eq:
                             - ${private_endpoint_strategy}
                             - "Create New Private Endpoint"
    required: true
    title: "Private Endpoint Network Security Group"
    description: "Network security group (NSG) to be used for controlling traffic to the private endpoint."
    dependsOn:
       compartmentId: ${private_endpoint_nsg_compartment_id}
       vcnId: ${existing_vcn_id}

  use_lb_nsg:
    type: boolean
    default: false
    visible: ${add_load_balancer}
    title: Use Network Security Group for Load Balancer
    description: Use a network security group (NSG) for controlling traffic to the load balancer.

  lb_nsg_compartment_id:
    type: oci:identity:compartment:id
    required: true
    title: "Network Security Group Compartment"
    description: "Choose the compartment of the network security group (NSG)."
    default: ${network_compartment_id}
    visible:
      and:
          - ${use_lb_nsg}
          - ${add_load_balancer}

  lb_nsg_id:
    type: oci:core:nsg:id
    visible:
      and:
          - ${use_lb_nsg}
          - ${add_load_balancer}
    required: true
    title: "Load Balancer Network Security Group"
    description: "Network security group (NSG) to be used for controlling traffic to the load balancer."
    dependsOn:
       compartmentId: ${soa_nsg_compartment_id}
       vcnId: ${existing_vcn_id}

  is_quickstart:
    type: boolean
    default: false
    visible: false
    title: Is Quick Start deployment
    description: Select this checkbox if it is a quick start deployment


  atp_db_name:
    type: string
    default: ATP
    visible: false
    title: ATP DB Name
    description: Name of the ATP Database


  atp_db_license_model:
    type: string
    default: LICENSE_INCLUDED
    visible: false
    title: ATP License model
    description: ATP Database license model


  atp_db_workload:
    type: string
    default: OLTP
    visible: false
    title: ATP Workload
    description: ATP Database work load


  atp_db_display_name:
    type: string
    default: ATP
    visible: false
    title: ATP DB Display Name
    description: ATP Database display name

  atp_db_is_dedicated:
    type: boolean
    default: false
    visible: false
    title: Is Dedicated ATP
    description: Select this checkbox if the ATP Database is dedicated

  skip_domain_creation:
    type: boolean
    default: false
    visible: false
    title: Skip SOAMP Domain creation

outputs:
  Weblogic_Administration_Console:
    type: link
    title: Weblogic Administration Console
    visible: true

  Enterprise_Manager_Console:
    type: link
    title: Enterprise Manager Console
    visible: true


  MFT_Console:
    type: link
    title: MFT Console
    visible: 
      eq:
        - ${topology}
        - "MFT Cluster"


  SOA_Composer_Console:
    type: link
    title: SOA Composer Console
    visible: 
      eq:
        - ${topology}
        - "SOA with SB & B2B Cluster"


  B2B_Console:
    type: link
    title: B2B Console
    visible: 
      eq:
        - ${topology}
        - "SOA with SB & B2B Cluster"


  OSB_Console:
    type: link
    title: ServiceBus Console
    visible: 
      eq:
        - ${topology}
        - "SOA with SB & B2B Cluster"


  Worklist_Application_Console:
    type: link
    title: Worklist Application Console
    visible: 
      eq:
        - ${topology}
        - "SOA with SB & B2B Cluster"

  Service_Type:
    type: string
    title: Service Type
    visible: true

  SOAMP_Stack_Version:
    type: string
    title: SOAMP Stack Version
    visible: true

  SOAMP_Cluster_Size:
    type: string
    title: SOAMP Cluster Size
    visible: true

  Loadbalancer_Ocid:
    type: ocid
    title: Loadbalancer
    visible: ${add_load_balancer}

  Service_Instances:
    type: string
    title: Service Instances
    visible: false

  DB_Connection:
    type: ocid
    title: Database
    visible: true

outputGroups:

   - title: SOA Suite Stack Details
     outputs:
      - ${Service_Type}
      - ${SOAMP_Stack_Version}
      - ${SOAMP_Cluster_Size}

   - title: Service Consoles
     outputs:
      - ${Weblogic_Administration_Console}
      - ${Enterprise_Manager_Console}
      - ${MFT_Console}
      - ${SOA_Composer_Console}
      - ${OSB_Console}
      - ${B2B_Console}
      - ${Worklist_Application_Console}

   - title: Associated Services
     outputs:
      - ${DB_Connection}
      - ${Loadbalancer_Ocid}
